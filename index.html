<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Inscrição Corrida</title>
    <!-- Fontes e Ícones -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;800&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
      /* --- CONFIGURAÇÕES VISUAIS --- */
      :root {
        --primary: #0d47a1; 
        --primary-light: #5472d3;
        --accent: #ff6f00; 
        --accent-glow: rgba(255, 111, 0, 0.4);
        --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        --glass-bg: rgba(255, 255, 255, 0.85);
        --glass-border: rgba(255, 255, 255, 0.9);
        --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        --error: #d32f2f;
        --success: #2e7d32;
      }
      
      * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
      
      body {
        font-family: 'Roboto', sans-serif;
        background: var(--bg-gradient);
        background-attachment: fixed;
        margin: 0; padding: 0;
        color: #333;
        display: flex; flex-direction: column; min-height: 100vh;
        overflow-x: hidden;
      }

      /* --- SPLASH SCREEN --- */
      #splash-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: white;
        z-index: 9999;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        transition: opacity 0.8s ease-out, transform 0.8s ease-out;
      }
      
      .splash-logo {
        width: 100px; height: 100px;
        background: var(--primary);
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        color: white; font-size: 40px;
        box-shadow: 0 0 0 0 rgba(13, 71, 161, 0.7);
        animation: pulse-white 2s infinite;
      }
      
      @keyframes pulse-white {
        0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(13, 71, 161, 0.7); }
        70% { transform: scale(1); box-shadow: 0 0 0 20px rgba(13, 71, 161, 0); }
        100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(13, 71, 161, 0); }
      }
      
      .splash-hidden { opacity: 0; pointer-events: none; transform: scale(1.1); }

      /* --- HEADER --- */
      .header-container { width: 100%; height: 280px; position: relative; overflow: hidden; border-radius: 0 0 30px 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
      .header-image { width: 100%; height: 100%; object-fit: cover; animation: zoomInHeader 20s infinite alternate; }
      @keyframes zoomInHeader { from { transform: scale(1); } to { transform: scale(1.1); } }
      .header-overlay { position: absolute; top:0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(13, 71, 161, 0.1), rgba(0,0,0,0.6)); }
      
      .logo-wrapper { position: relative; margin-top: -75px; display: flex; justify-content: center; z-index: 10; padding: 0 20px; animation: dropIn 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; animation-delay: 0.5s; opacity: 0; }
      @keyframes dropIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

      .logo-img, .logo-placeholder { width: 140px; height: 140px; border-radius: 50%; border: 6px solid white; background: white; box-shadow: 0 10px 30px rgba(0,0,0,0.2); object-fit: cover; }
      .logo-placeholder { display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 3.5rem; }

      .container { max-width: 550px; width: 100%; margin: 0 auto; padding: 10px 20px 40px; flex: 1; position: relative; z-index: 5; }

      /* TIPOGRAFIA */
      h1.event-title { text-align: center; color: var(--primary); font-family: 'Montserrat', sans-serif; font-size: 1.8rem; font-weight: 800; margin: 15px 0 5px; text-transform: uppercase; letter-spacing: -0.5px; text-shadow: 1px 1px 0px rgba(255,255,255,0.5); }
      .event-location { text-align: center; color: #666; font-size: 1rem; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; gap: 8px; font-weight: 500; }
      .event-location i { color: var(--accent); animation: bouncePin 2s infinite; }
      @keyframes bouncePin { 0%, 100% {transform:translateY(0);} 50% {transform:translateY(-5px);} }

      /* MOTIVACIONAL */
      .motivational-box { text-align: center; margin: 0 0 25px; padding: 15px; background: linear-gradient(135deg, var(--primary), var(--primary-light)); border-radius: 15px; box-shadow: 0 5px 15px rgba(13, 71, 161, 0.2); color: white; transform: scale(1); transition: transform 0.3s; }
      .motivational-box:hover { transform: scale(1.02); }
      .motivational-text { font-size: 1.1rem; font-weight: 600; font-style: italic; margin: 0; font-family: 'Montserrat', sans-serif; }
      
      /* PREMIAÇÃO */
      .prizes-box { background: var(--glass-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid var(--glass-border); border-radius: 20px; padding: 25px 20px; margin-bottom: 25px; box-shadow: var(--shadow); position: relative; overflow: hidden; animation: boxFadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) both; transition: transform 0.3s ease, box-shadow 0.3s ease; }
      .prizes-box:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(13, 71, 161, 0.15); }
      .prizes-box::before { content: ''; position: absolute; top:0; left:0; width: 6px; height: 100%; background: var(--accent); }
      .prizes-title { color: var(--primary); font-family: 'Montserrat', sans-serif; font-weight: 800; margin-bottom: 20px; text-align: left; padding-left: 10px; text-transform: uppercase; font-size: 1.1rem; letter-spacing: 1px; border-bottom: 2px solid rgba(0,0,0,0.05); padding-bottom: 10px; }
      .prize-item { display: flex; flex-direction: row; align-items: center; justify-content: center; padding: 12px 10px; background: white; margin-bottom: 10px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.03); transition: transform 0.2s; opacity: 0; animation: itemSlideIn 0.5s ease-out forwards; gap: 10px; flex-wrap: wrap; }
      .prize-item:hover { transform: translateX(5px); }
      .prize-item:nth-child(1) { animation-delay: 0.2s; }
      .prize-item:nth-child(2) { animation-delay: 0.3s; }
      .prize-item:nth-child(3) { animation-delay: 0.4s; }
      .prize-item:nth-child(4) { animation-delay: 0.5s; }
      .prize-item:nth-child(5) { animation-delay: 0.6s; }
      .prize-age { font-weight: 700; color: white; background: var(--primary); padding: 6px 12px; border-radius: 8px; font-size: 0.8rem; min-width: 100px; text-align: center; box-shadow: 0 2px 5px rgba(13, 71, 161, 0.3); }
      .prize-value { color: #444; font-weight: 700; text-align: left; font-size: 0.95rem; }
      .prize-obs { font-size: 0.85rem; color: #555; text-align: center; margin-top: 15px; background: #fff3e0; padding: 12px; border-radius: 10px; border-left: 4px solid var(--accent); }
      
      @keyframes boxFadeInUp { from { opacity: 0; transform: translateY(30px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
      @keyframes itemSlideIn { from { opacity: 0; transform: translateX(-15px); } to { opacity: 1; transform: translateX(0); } }

      /* FORMULÁRIO */
      .form-card { background: var(--glass-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid var(--glass-border); border-radius: 25px; padding: 25px; box-shadow: var(--shadow); }
      .input-group { position: relative; margin-bottom: 20px; background: white; border-radius: 12px; transition: 0.3s; box-shadow: 0 2px 6px rgba(0,0,0,0.02); border: 2px solid transparent; }
      .input-group:focus-within { border-color: var(--primary); box-shadow: 0 4px 12px rgba(13, 71, 161, 0.15); transform: translateY(-2px); }
      .input-group.error { border-color: var(--error); animation: shake 0.4s ease-in-out; }
      .input-group.error i { color: var(--error); }
      @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px);} 75% {transform: translateX(5px);} }
      .input-group i { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); color: #aaa; font-size: 1.1rem; transition: 0.3s; }
      .input-group:focus-within i { color: var(--primary); }
      input, select { width: 100%; padding: 18px 18px 18px 50px; border: none; background: transparent; font-size: 1rem; color: #333; outline: none; border-radius: 12px; -webkit-appearance: none; font-weight: 500; }
      .btn-submit { width: 100%; padding: 18px; background: linear-gradient(135deg, var(--primary), #1565c0); color: white; border: none; border-radius: 50px; font-size: 1.2rem; font-weight: 800; font-family: 'Montserrat', sans-serif; text-transform: uppercase; cursor: pointer; margin-top: 15px; box-shadow: 0 10px 20px rgba(13, 71, 161, 0.3); transition: all 0.3s; position: relative; overflow: hidden; }
      .btn-submit:hover { transform: translateY(-3px); box-shadow: 0 15px 25px rgba(13, 71, 161, 0.4); }
      .btn-submit:active { transform: scale(0.98); }
      .btn-submit::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: shine 3s infinite; }
      @keyframes shine { 100% { left: 100%; } }

      /* BOTÃO FLUTUANTE (FAB) */
      .fab-info { position: fixed; bottom: 30px; right: 20px; width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), #ff9100); color: white; border: none; box-shadow: 0 4px 15px rgba(255, 111, 0, 0.4); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; z-index: 100; transition: transform 0.3s, box-shadow 0.3s; }
      .fab-info:hover { transform: scale(1.1) rotate(10deg); }

      /* ADMIN */
      .admin-panel { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
      .admin-header { background: linear-gradient(to right, var(--primary), #1565c0); padding: 20px; display: flex; justify-content: space-between; align-items: center; color: white; }
      .admin-tabs { background: #f0f2f5; padding: 10px; display: flex; gap: 10px; overflow-x: auto; }
      .admin-tab { padding: 10px 20px; border-radius: 20px; color: #666; font-weight: 600; cursor: pointer; transition: 0.3s; border: none; background: transparent; white-space: nowrap; }
      .admin-tab.active { background: white; color: var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
      .admin-content { padding: 25px; }
      .tab-view { display: none; }
      .tab-view.active { display: block; animation: fadeIn 0.3s; }
      @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
      .total-card { text-align: center; padding: 30px; background: linear-gradient(135deg, #e3f2fd, #bbdefb); border-radius: 20px; border: none; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(33, 150, 243, 0.15); color: var(--primary); }
      .total-number { font-size: 4rem; font-weight: 800; line-height: 1; text-shadow: 2px 2px 0 rgba(255,255,255,0.5); }
      .filters-container { display: flex; gap: 10px; margin-bottom: 15px; }
      .filter-group { flex: 1; }
      .filter-select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; background-color: #fcfcfc; }
      .btn-print { width: 100%; padding: 15px; background: var(--accent); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; display: flex; justify-content: center; align-items: center; gap: 8px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(255, 111, 0, 0.3); }
      
      .config-input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 0.95rem; background: #f9f9f9; }
      .btn-save-config { background: #4CAF50; color: white; width: 100%; padding: 15px; border: none; border-radius: 12px; margin-top: 25px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3); }
      .upload-group { display: flex; gap: 10px; }
      .btn-upload { background: var(--primary); color: white; border: none; padding: 0 15px; border-radius: 10px; cursor: pointer; }
      .premio-row { display: flex; gap: 8px; margin-bottom: 12px; align-items: center; }
      .btn-remove { background: #ff5252; color: white; border: none; width: 42px; height: 42px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
      .btn-add { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 30px; cursor: pointer; font-size: 0.85rem; margin-bottom: 15px; display: inline-flex; align-items: center; gap: 8px; font-weight: bold; }

      /* MODAIS */
      .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 2000; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
      .modal-overlay.active { opacity: 1; pointer-events: all; }
      .modal-box { background: white; width: 90%; max-width: 400px; padding: 30px; border-radius: 25px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.3); transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); max-height: 85vh; overflow-y: auto; position: relative; }
      .modal-overlay.active .modal-box { transform: scale(1); }
      .modal-input { width: 100%; padding: 15px; margin: 20px 0; border: 2px solid #eee; border-radius: 12px; text-align: center; font-size: 1.2rem; letter-spacing: 3px; font-weight: bold; }
      .btn-modal { padding: 12px 25px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: 0.2s; }
      .btn-confirm { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(13, 71, 161, 0.2); }
      .btn-cancel { background: #f0f0f0; color: #666; margin-right: 10px; }
      
      /* Botão Fechar Modal (X) */
      .btn-close-modal {
        position: absolute; top: 15px; right: 15px;
        background: #f0f0f0; color: #666;
        width: 35px; height: 35px; border-radius: 50%;
        border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;
        font-weight: bold; font-size: 1rem; transition: 0.2s;
      }
      .btn-close-modal:hover { background: #e0e0e0; color: #333; }

      .info-content { text-align: left; white-space: pre-line; color: #555; line-height: 1.6; max-height: 300px; overflow-y: auto; background: #f9f9f9; padding: 15px; border-radius: 12px; border: 1px solid #eee; margin-top: 10px;}

      /* LOADER ANIMADO (Boneco Correndo) */
      .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.95); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; backdrop-filter: blur(5px); }
      .loading-overlay.active { opacity: 1; pointer-events: all; }
      
      .track-container {
        width: 250px; height: 100px; position: relative;
        overflow: hidden; display: flex; align-items: flex-end; justify-content: flex-start;
        border-bottom: 2px solid #ddd;
      }
      
      .runner-animation {
        font-size: 60px; color: var(--accent);
        position: absolute; bottom: 0; left: -60px;
        animation: runAcrossScreen 2s linear infinite;
      }
      
      @keyframes runAcrossScreen {
        0% { left: -60px; transform: scaleX(1); }
        45% { transform: scaleX(1); }
        50% { left: 260px; transform: scaleX(1); } /* Sai da tela */
        50.1% { transform: scaleX(-1); left: 260px;} /* Vira */
        95% { transform: scaleX(-1); }
        100% { left: -60px; transform: scaleX(-1); } /* Volta */
      }

      .loading-text { font-weight: 800; color: var(--primary); font-size: 1.3rem; margin-top: 20px; animation: pulse 1s infinite; text-transform: uppercase; letter-spacing: 1px; }

      /* SUCESSO */
      .success-box { background: white; padding: 40px 20px; border-radius: 25px; text-align: center; box-shadow: 0 15px 50px rgba(0,0,0,0.15); animation: fadeInUp 0.5s ease-out; position: relative; overflow: hidden; }
      .success-message { font-size: 1.1rem; color: #555; margin: 15px 0; line-height: 1.6; }
      .confetti { position: absolute; width: 10px; height: 10px; background-color: #f00; animation: fall linear forwards; }
      @keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }
      @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-20px);} 60% {transform: translateY(-10px);} }
      .medal-bounce { animation: bounce 2s infinite; }
      .hidden { display: none !important; }
      
      footer { text-align: center; padding: 30px 20px 80px; font-size: 0.8rem; color: #888; }
      .dev-credit { font-weight: 600; color: var(--primary); }
      .admin-toggle { background: none; border: none; color: #ccc; margin-top: 10px; cursor: pointer; font-size: 1.3rem; transition: 0.3s; }
      .admin-toggle:hover { color: var(--primary); }

      /* PRINT */
      @media print {
        @page { size: landscape; margin: 1cm; }
        .header-container, .logo-wrapper, .form-card, footer, .btn-action, #success-view, .admin-toggle, .motivational-box, .modal-overlay, .admin-header button, .admin-tabs, .btn-print, #tab-config, .config-form, .prizes-box, .filters-container, .fab-info, .upload-group .btn-upload, #tab-premios, .btn-save-config { display: none !important; }
        body, .container { background: white; margin: 0; padding: 0; width: 100%; max-width: 100%; }
        #admin-view { display: block !important; box-shadow: none; width: 100%; }
        .admin-panel { box-shadow: none; padding: 0; width: 100%; }
        .admin-header { background: white; color: black; border-bottom: 2px solid black; padding: 10px; margin-bottom: 20px; display: block; text-align: center; }
        .admin-header h2 { font-size: 18pt; text-transform: uppercase; }
        .total-card { border: 1px solid #000; background: none; page-break-inside: avoid; margin-bottom: 20px; padding: 5px; text-align: left; color: black; box-shadow: none; }
        .total-number { color: black; font-size: 14pt; display: inline-block; margin-left: 10px; }
        .total-card h3 { color: black; font-size: 12pt; display: inline-block; margin: 0; }
        .table-responsive { overflow: visible; box-shadow: none; }
        table { font-size: 9pt; border: 1px solid #000; width: 100%; border-collapse: collapse; table-layout: auto; }
        th { background-color: #ddd !important; color: black; border: 1px solid #000; padding: 4px; text-align: left; -webkit-print-color-adjust: exact; }
        td { border: 1px solid #000; padding: 4px; word-wrap: break-word; }
        tr[style*="display: none"] { display: none !important; }
      }
    </style>
</head>
<body>

    <!-- SPLASH SCREEN (INTRO) -->
    <div id="splash-screen">
      <div class="splash-logo"><i class="fas fa-running"></i></div>
      <p style="margin-top:20px; color:#666; font-weight:500;">Carregando...</p>
    </div>

    <!-- CABEÇALHO -->
    <div class="header-container">
        <div style="height:100%; background:var(--primary); display:flex; align-items:center; justify-content:center; color:rgba(255,255,255,0.2); font-size:5rem;"><i class="fas fa-image"></i></div>
    </div>
    <div class="logo-wrapper">
        <div class="logo-placeholder"><i class="fas fa-running"></i></div>
    </div>

    <!-- BOTÃO FLUTUANTE -->
    <button class="fab-info" onclick="abrirModalInfo()"><i class="fas fa-info"></i></button>

    <div class="container">
      <!-- FORMULÁRIO -->
      <div id="form-view">
        <h1 class="event-title">Carregando Evento...</h1>
        <!-- EXIBIÇÃO DO LOCAL -->
        <div class="event-location"><i class="fas fa-map-marker-alt"></i> <span id="display-local">...</span></div>
        
        <div class="motivational-box" style="display:none;"><p class="motivational-text"></p></div>
        <p class="event-subtitle">Preencha seus dados para confirmar a presença.</p>

        <!-- PREMIAÇÃO GERAL -->
        <div id="prizes-geral-container" class="prizes-box" style="display:none;">
          <div class="prizes-title"><i class="fas fa-trophy"></i> Premiação Geral</div>
          <div id="user-prizes-list" class="prize-list"></div>
          <div id="user-prizes-obs" class="prize-obs" style="display:none;"></div>
        </div>

        <!-- PREMIAÇÃO POR CATEGORIA -->
        <div id="prizes-cat-container" class="prizes-box" style="display:none;">
          <div class="prizes-title"><i class="fas fa-medal"></i> Premiação por Categoria</div>
          <div id="user-prizes-cat-list" class="prize-list"></div>
          <div id="user-prizes-cat-obs" class="prize-obs" style="display:none;"></div>
        </div>

        <form id="cadastroForm" class="form-card" onsubmit="enviarDados(event)">
          <div class="input-group"><i class="fas fa-user"></i><input type="text" id="nome" placeholder="Nome Completo" required></div>
          <div class="input-group"><i class="fas fa-id-card"></i><input type="text" id="cpf" placeholder="CPF (000.000.000-00)" maxlength="14" oninput="mascaraCPF(this)" required></div>
          <div class="input-group"><i class="fas fa-calendar-alt"></i><input type="text" id="nascimento" placeholder="Data de Nascimento" onfocus="ativarData(this)" onblur="formatarDataVisual(this)" required></div>
          <div class="input-group"><i class="fas fa-venus-mars"></i>
            <select id="genero" required>
              <option value="" disabled selected>Selecione o Gênero</option>
              <option value="Masculino">Masculino</option>
              <option value="Feminino">Feminino</option>
            </select>
          </div>
          <div class="input-group"><i class="fas fa-users"></i><input type="text" id="equipe" placeholder="Nome da Equipe (Opcional)"></div>
          <div class="input-group"><i class="fas fa-phone-alt"></i><input type="text" id="telefone" placeholder="Telefone / WhatsApp" maxlength="15" oninput="mascaraTelefone(this)" required></div>
          <div class="input-group"><i class="fas fa-map-marker-alt"></i><input type="text" id="endereco" placeholder="Endereço Completo" required></div>
          <button type="submit" class="btn-submit">Confirmar Inscrição</button>
        </form>
      </div>

      <!-- SUCESSO ANIMADO -->
      <div id="success-view" class="hidden">
        <div class="success-box" id="success-box-content">
          <i class="fas fa-medal fa-4x medal-bounce" style="color: gold; margin-bottom: 20px;"></i>
          <h2 style="color: var(--primary); text-transform: uppercase;">Parabéns, <span id="success-name">Atleta</span>!</h2>
          <p class="success-message">Sua inscrição foi confirmada.<br>Prepare-se para superar seus limites!</p>
          <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
          <button onclick="novaInscricao()" class="btn-submit" style="background:#eee; color:#555; box-shadow:none;"><i class="fas fa-redo"></i> Nova Inscrição</button>
        </div>
      </div>

      <!-- ADMIN -->
      <div id="admin-view" class="hidden">
        <div class="admin-panel">
          <div class="admin-header"><h2><i class="fas fa-cog"></i> Administração</h2><button onclick="novaInscricao()"><i class="fas fa-sign-out-alt"></i> Sair</button></div>
          <!-- ABAS DO ADMIN -->
          <div class="admin-tabs">
            <button class="admin-tab active" onclick="mudarAba('dashboard')">Dashboard</button>
            <button class="admin-tab" onclick="mudarAba('config')">Configurações</button>
            <button class="admin-tab" onclick="mudarAba('premios')">Premiação</button>
          </div>
          
          <div class="admin-content">
            <!-- ABA DASHBOARD -->
            <div id="tab-dashboard" class="tab-view active">
              <div class="total-card"><h3>Total de Inscritos (Filtrado)</h3><div class="total-number" id="admin-total">0</div></div>
              
              <!-- FILTROS DUPLOS -->
              <div class="filters-container">
                <div class="filter-group">
                  <label>Filtrar por Categoria:</label>
                  <select id="filter-cat" class="filter-select" onchange="filtrarTabela()">
                    <option value="Todas">Todas as Categorias</option>
                    <option value="16 a 29 anos">16 a 29 anos</option>
                    <option value="30 a 39 anos">30 a 39 anos</option>
                    <option value="40 a 49 anos">40 a 49 anos</option>
                    <option value="50 a 59 anos">50 a 59 anos</option>
                    <option value="+60 anos">+60 anos</option>
                  </select>
                </div>
                <div class="filter-group">
                  <label>Filtrar por Gênero:</label>
                  <select id="filter-gen" class="filter-select" onchange="filtrarTabela()">
                    <option value="Todos">Todos</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Feminino">Feminino</option>
                  </select>
                </div>
              </div>

              <button onclick="window.print()" class="btn-print"><i class="fas fa-file-pdf"></i> Imprimir Relatório (PDF)</button>
              <div class="table-responsive"><table id="admin-table"><thead><tr><th>Data</th><th>Nome</th><th>CPF</th><th>Nasc.</th><th>Tel</th><th>Gênero</th><th>Equipe</th><th>Idade</th><th>Cat.</th><th>Endereço</th></tr></thead><tbody></tbody></table></div>
            </div>
            
            <!-- ABA CONFIGURAÇÕES -->
            <div id="tab-config" class="tab-view">
              <div class="config-form">
                <div class="config-section-title">Geral</div>
                <label>Nome do Evento</label><input type="text" id="cfg-nome" class="config-input">
                <label>Local do Evento</label><input type="text" id="cfg-local" class="config-input">
                <label>Imagem de Capa</label>
                <div class="upload-group"><input type="text" id="cfg-capa" class="config-input"><button type="button" class="btn-upload" onclick="document.getElementById('file-capa').click()"><i class="fas fa-cloud-upload-alt"></i></button><input type="file" id="file-capa" hidden accept="image/*" onchange="uploadImgBB(this, 'cfg-capa')"></div>
                <label>Imagem do Logo</label>
                <div class="upload-group"><input type="text" id="cfg-logo" class="config-input"><button type="button" class="btn-upload" onclick="document.getElementById('file-logo').click()"><i class="fas fa-cloud-upload-alt"></i></button><input type="file" id="file-logo" hidden accept="image/*" onchange="uploadImgBB(this, 'cfg-logo')"></div>
                <label>Frase Motivacional</label><input type="text" id="cfg-frase" class="config-input">
                <label>Senha do Administrador</label><input type="text" id="cfg-senha" class="config-input">
                <div class="config-section-title">Informações do Evento</div>
                <label>Regras e Detalhes</label><textarea id="cfg-regras" class="config-input"></textarea>
                <button onclick="salvarConfig()" class="btn-save-config"><i class="fas fa-save"></i> Salvar Alterações</button>
              </div>
            </div>

            <!-- ABA PREMIAÇÃO DINÂMICA -->
            <div id="tab-premios" class="tab-view">
              <div class="config-form">
                <div class="config-section-title">Premiação Geral</div>
                <button type="button" class="btn-add" onclick="addPremioRow('admin-premios-list')"><i class="fas fa-plus"></i> Adicionar Prêmio</button>
                <div id="admin-premios-list"></div>
                <label style="margin-top:10px;">Observação (Geral)</label>
                <textarea id="cfg-obs-premio" class="config-input" style="height:60px;"></textarea>

                <div class="config-section-title" style="margin-top:30px;">Premiação por Categoria</div>
                <button type="button" class="btn-add" onclick="addPremioRow('admin-premios-cat-list')"><i class="fas fa-plus"></i> Adicionar Prêmio</button>
                <div id="admin-premios-cat-list"></div>
                <label style="margin-top:10px;">Observação (Categoria)</label>
                <textarea id="cfg-obs-premio-cat" class="config-input" style="height:60px;"></textarea>

                <button onclick="salvarConfig()" class="btn-save-config" style="margin-top:20px;"><i class="fas fa-save"></i> Salvar Prêmios</button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- MODAIS -->
    <div id="modal-senha" class="modal-overlay">
      <div class="modal-box">
        <button class="btn-close-modal" onclick="fecharModalAdmin()"><i class="fas fa-times"></i></button>
        <i class="fas fa-lock fa-2x" style="color:var(--primary); margin-bottom:10px;"></i>
        <h3>Área Restrita</h3>
        <input type="password" id="input-senha-modal" class="modal-input" placeholder="••••••">
        <p id="erro-senha" style="color:red; font-size:0.8rem; display:none;">Senha incorreta!</p>
        <div class="modal-actions"><button class="btn-modal btn-confirm" onclick="confirmarLoginAdmin()">Entrar</button></div>
      </div>
    </div>

    <div id="modal-info" class="modal-overlay">
      <div class="modal-box">
        <button class="btn-close-modal" onclick="fecharModalInfo()"><i class="fas fa-times"></i></button>
        <i class="fas fa-info-circle fa-2x" style="color:var(--accent); margin-bottom:10px;"></i>
        <h3>Informações do Evento</h3>
        <div id="info-texto" class="info-content"></div>
      </div>
    </div>

    <div id="modal-aviso" class="modal-overlay">
      <div class="modal-box">
        <i id="aviso-icon" class="fas fa-exclamation-circle fa-2x" style="margin-bottom:10px;"></i>
        <h3 id="aviso-titulo">Aviso</h3>
        <p id="aviso-texto" style="color:#666; margin-bottom:20px;"></p>
        <div class="modal-actions"><button class="btn-modal btn-confirm" onclick="fecharModalAviso()">OK</button></div>
      </div>
    </div>

    <!-- LOADING OVERLAY ANIMADO -->
    <div id="loading-overlay" class="loading-overlay">
      <div class="track-container">
        <div class="runner-animation"><i class="fas fa-running"></i></div>
      </div>
      <div class="loading-text">Processando...</div>
    </div>

    <footer><p>Desenvolvido por <span class="dev-credit">Thiego Pereira</span></p><button class="admin-toggle" onclick="abrirModalAdmin()"><i class="fas fa-lock"></i></button></footer>

    <script>
      // --- CONFIGURAÇÃO ---
      const API_URL = "https://script.google.com/macros/s/AKfycbwAQk2VM3oGr5ZhHge7ZIPy7hzQz-TqFO3u8QeAzjTEaCNURDvJW39Cyk-0MEXwzHRw/exec";
      const IMGBB_API_KEY = "fa0265b3bfc740c1eb09a7e4d6ec493a";

      // --- INICIALIZAÇÃO ---
      document.addEventListener('DOMContentLoaded', () => {
        fetch(`${API_URL}?action=ping`).catch(() => {});
        carregarConfigsIniciais();
      });

      function carregarConfigsIniciais() {
        document.querySelector('.loading-text').innerText = "A carregar evento...";
        
        fetch(`${API_URL}?action=getConfig`)
          .then(res => res.json())
          .then(data => {
            if(data.status === 'success') {
              atualizarInterface(data.data);
            }
            // Remove splash screen suavemente
            const splash = document.getElementById('splash-screen');
            splash.classList.add('splash-hidden');
            setTimeout(() => splash.style.display = 'none', 800);
          })
          .catch(err => {
            console.error(err);
            document.getElementById('splash-screen').style.display = 'none'; // Fecha mesmo com erro para não travar
          });
      }

      function atualizarInterface(cfg) {
        const headerContainer = document.querySelector('.header-container');
        if(cfg.URL_CAPA) headerContainer.innerHTML = `<img src="${cfg.URL_CAPA}" class="header-image"><div class="header-overlay"></div>`;
        
        const logoWrapper = document.querySelector('.logo-wrapper');
        if(cfg.URL_LOGO) logoWrapper.innerHTML = `<img src="${cfg.URL_LOGO}" class="logo-img">`;
        
        document.querySelector('h1.event-title').innerText = cfg.NOME_EVENTO;
        document.getElementById('display-local').innerText = cfg.LOCAL_EVENTO || "";
        
        const motBox = document.querySelector('.motivational-box');
        if (cfg.FRASE_MOTIVACIONAL) {
           motBox.style.display = 'block';
           motBox.querySelector('.motivational-text').innerHTML = `<i class="fas fa-quote-left" style="font-size:0.8em;"></i> ${cfg.FRASE_MOTIVACIONAL} <i class="fas fa-quote-right" style="font-size:0.8em;"></i>`;
        } else { motBox.style.display = 'none'; }

        // Renderiza Prémios
        renderizarListaPremios(cfg.LISTA_PREMIOS, 'user-prizes-list', 'prizes-geral-container');
        const obsDiv = document.getElementById('user-prizes-obs');
        if(cfg.OBS_PREMIACAO) { obsDiv.style.display = 'block'; obsDiv.innerText = cfg.OBS_PREMIACAO; } else { obsDiv.style.display = 'none'; }

        renderizarListaPremios(cfg.LISTA_PREMIOS_CAT, 'user-prizes-cat-list', 'prizes-cat-container');
        const obsCatDiv = document.getElementById('user-prizes-cat-obs');
        if(cfg.OBS_PREMIACAO_CAT) { obsCatDiv.style.display = 'block'; obsCatDiv.innerText = cfg.OBS_PREMIACAO_CAT; } else { obsCatDiv.style.display = 'none'; }

        document.getElementById('info-texto').innerText = cfg.REGRAS_EVENTO || "Sem informações adicionais.";
      }

      function renderizarListaPremios(jsonString, listId, containerId) {
        const listEl = document.getElementById(listId);
        const containerEl = document.getElementById(containerId);
        listEl.innerHTML = "";
        let lista = [];
        try { lista = JSON.parse(jsonString); } catch(e) {}
        
        if (lista && lista.length > 0) {
          containerEl.style.display = 'block';
          lista.forEach(p => {
            listEl.innerHTML += `<div class="prize-item"><span class="prize-age">${p.titulo}</span> <span class="prize-value">${p.valor}</span></div>`;
          });
        } else {
          containerEl.style.display = 'none';
        }
      }

      /* API IMGBB */
      function uploadImgBB(input, targetId) {
        if (input.files && input.files[0]) {
          const formData = new FormData(); formData.append("image", input.files[0]); formData.append("key", IMGBB_API_KEY);
          document.getElementById('loading-overlay').classList.add('active'); document.querySelector('.loading-text').innerText = "A enviar imagem...";
          fetch("https://api.imgbb.com/1/upload", { method: "POST", body: formData }).then(res => res.json()).then(data => {
              document.getElementById('loading-overlay').classList.remove('active');
              if (data.success) { document.getElementById(targetId).value = data.data.url; mostrarAviso("Sucesso", "Imagem carregada!", false); } else { mostrarAviso("Erro", "Falha ao enviar imagem.", true); }
          }).catch(() => { document.getElementById('loading-overlay').classList.remove('active'); mostrarAviso("Erro", "Erro de conexão ImgBB.", true); });
        }
      }

      /* MASCARAS */
      function mascaraCPF(i) { var v = i.value; if(isNaN(v[v.length-1])){ i.value = v.substring(0, v.length-1); return; } v = v.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"); i.value = v; }
      function mascaraTelefone(i) { var v = i.value; v = v.replace(/\D/g,"").replace(/^(\d{2})(\d)/g,"($1) $2").replace(/(\d)(\d{4})$/,"$1-$2"); i.value = v; }
      function ativarData(input) { if (input.value && input.value.includes('/')) { const p = input.value.split('/'); input.value = `${p[2]}-${p[1]}-${p[0]}`; } input.type = 'date'; if(input.showPicker) try{input.showPicker()}catch(e){}; }
      function formatarDataVisual(input) { const v = input.value; if (v && v.includes('-')) { const p = v.split('-'); input.type = 'text'; input.value = `${p[2]}/${p[1]}/${p[0]}`; } else if (!v) input.type = 'text'; }

      /* AVISO */
      function mostrarAviso(titulo, texto, isErro = false) {
        document.getElementById('aviso-titulo').innerText = titulo; document.getElementById('aviso-texto').innerText = texto;
        const icon = document.getElementById('aviso-icon'); if(isErro) { icon.className = "fas fa-times-circle fa-2x"; icon.style.color = "var(--error)"; } else { icon.className = "fas fa-check-circle fa-2x"; icon.style.color = "var(--success)"; }
        document.getElementById('modal-aviso').classList.add('active');
      }
      function fecharModalAviso() { document.getElementById('modal-aviso').classList.remove('active'); }

      /* LOGICA ENVIO (POST) */
      function enviarDados(e) {
        e.preventDefault(); 
        let valido = true; const requireds = document.querySelectorAll('#cadastroForm [required]');
        requireds.forEach(el => { const group = el.closest('.input-group'); if(!el.value) { group.classList.add('error'); valido = false; } else { group.classList.remove('error'); } });
        const cpf = document.getElementById('cpf'); if(cpf.value.length < 14) { cpf.closest('.input-group').classList.add('error'); valido = false; }
        if(!valido) { document.querySelector('.error').scrollIntoView({behavior: 'smooth', block: 'center'}); return; }

        document.getElementById('loading-overlay').classList.add('active');
        document.querySelector('.loading-text').innerText = "Salvando cadastro...";
        
        const nomeCompleto = document.getElementById('nome').value; const primeiroNome = nomeCompleto.split(' ')[0];
        const dados = { action: 'salvarCadastro', payload: { nome: nomeCompleto, cpf: document.getElementById('cpf').value, nascimento: document.getElementById('nascimento').value, telefone: document.getElementById('telefone').value, endereco: document.getElementById('endereco').value, genero: document.getElementById('genero').value, equipe: document.getElementById('equipe').value } };
        
        fetch(API_URL, { method: 'POST', body: JSON.stringify(dados) })
          .then(res => res.json())
          .then(res => { 
            document.getElementById('loading-overlay').classList.remove('active'); 
            if (res.success) { 
              document.getElementById('success-name').innerText = primeiroNome;
              document.getElementById('form-view').classList.add('hidden'); 
              document.getElementById('success-view').classList.remove('hidden'); 
              window.scrollTo(0,0);
              
              for(let i=0; i<30; i++) {
                let confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDuration = (Math.random() * 2 + 1) + 's';
                confetti.style.backgroundColor = ['#f00', '#0f0', '#00f', '#ff0', '#0ff'][Math.floor(Math.random()*5)];
                document.getElementById('success-box-content').appendChild(confetti);
              }

            } else { mostrarAviso("Atenção", res.message, true); }
          })
          .catch(err => { document.getElementById('loading-overlay').classList.remove('active'); mostrarAviso("Erro", "Falha ao enviar. Tente novamente.", true); });
      }
      function novaInscricao() { 
        document.getElementById('cadastroForm').reset(); 
        document.getElementById('nascimento').type = 'text'; 
        document.querySelectorAll('.confetti').forEach(el => el.remove());
        document.getElementById('success-view').classList.add('hidden'); 
        document.getElementById('admin-view').classList.add('hidden'); 
        document.getElementById('form-view').classList.remove('hidden'); 
        window.scrollTo(0,0); 
      }

      /* MODAIS */
      function abrirModalInfo() { document.getElementById('modal-info').classList.add('active'); }
      function fecharModalInfo() { document.getElementById('modal-info').classList.remove('active'); }
      function abrirModalAdmin() { document.getElementById('modal-senha').classList.add('active'); document.getElementById('input-senha-modal').value = ''; document.getElementById('erro-senha').style.display = 'none'; document.getElementById('input-senha-modal').focus(); }
      function fecharModalAdmin() { document.getElementById('modal-senha').classList.remove('active'); }

      function confirmarLoginAdmin() {
        const senha = document.getElementById('input-senha-modal').value; const btn = document.querySelector('#modal-senha .btn-confirm'); const txt = btn.innerText; btn.innerText = "Verificando...";
        fetch(`${API_URL}?action=adminLogin&senha=${encodeURIComponent(senha)}`).then(res => res.json()).then(res => { btn.innerText = txt; if (res.success) { fecharModalAdmin(); carregarAdmin(res); } else { document.getElementById('erro-senha').innerText = res.message || "Senha incorreta!"; document.getElementById('erro-senha').style.display = 'block'; } }).catch(() => { btn.innerText = txt; mostrarAviso("Erro", "Falha de conexão.", true); });
      }
      document.getElementById('input-senha-modal').addEventListener('keyup', e => { if(e.key==='Enter') confirmarLoginAdmin() });

      /* ADMINISTRAÇÃO */
      let dadosAdminCache = [];
      function carregarAdmin(dados) {
        document.getElementById('form-view').classList.add('hidden'); document.getElementById('success-view').classList.add('hidden'); document.getElementById('admin-view').classList.remove('hidden');
        dadosAdminCache = dados.registros; filtrarTabela();
        const cfg = dados.configsAtuais;
        document.getElementById('cfg-nome').value = cfg.NOME_EVENTO || ""; document.getElementById('cfg-local').value = cfg.LOCAL_EVENTO || ""; document.getElementById('cfg-capa').value = cfg.URL_CAPA || ""; document.getElementById('cfg-logo').value = cfg.URL_LOGO || ""; document.getElementById('cfg-frase').value = cfg.FRASE_MOTIVACIONAL || ""; document.getElementById('cfg-senha').value = cfg.SENHA_ADMIN || "";
        document.getElementById('cfg-regras').value = cfg.REGRAS_EVENTO || "";
        
        loadAdminPremios(cfg.LISTA_PREMIOS, 'admin-premios-list');
        document.getElementById('cfg-obs-premio').value = cfg.OBS_PREMIACAO || "";
        loadAdminPremios(cfg.LISTA_PREMIOS_CAT, 'admin-premios-cat-list');
        document.getElementById('cfg-obs-premio-cat').value = cfg.OBS_PREMIACAO_CAT || "";
      }

      function loadAdminPremios(json, containerId) {
        const container = document.getElementById(containerId); container.innerHTML = "";
        let lista = []; try { lista = JSON.parse(json); } catch(e){}
        if(lista.length > 0) lista.forEach(p => addPremioRow(containerId, p.titulo, p.valor));
        else addPremioRow(containerId);
      }

      function addPremioRow(containerId, titulo = "", valor = "") {
        const div = document.createElement('div'); div.className = 'premio-row';
        div.innerHTML = `<input type="text" class="config-input p-titulo" placeholder="Título" value="${titulo}"><input type="text" class="config-input p-valor" placeholder="Prêmio" value="${valor}"><button type="button" class="btn-remove" onclick="this.parentElement.remove()"><i class="fas fa-trash"></i></button>`;
        document.getElementById(containerId).appendChild(div);
      }

      function filtrarTabela() {
        const filtroCat = document.getElementById('filter-cat').value; const filtroGen = document.getElementById('filter-gen').value;
        const tbody = document.querySelector('#admin-table tbody'); tbody.innerHTML = ""; let count = 0;
        dadosAdminCache.forEach(linha => {
          const cat = linha[8]; const gen = linha[5];
          if ((filtroCat === "Todas" || cat === filtroCat) && (filtroGen === "Todos" || gen === filtroGen)) { count++; tbody.innerHTML += `<tr><td>${linha[0]}</td><td>${linha[1]}</td><td>${linha[2]}</td><td>${linha[3]}</td><td>${linha[4]}</td><td>${linha[5]}</td><td>${linha[6]}</td><td>${linha[7]}</td><td><strong>${linha[8]}</strong></td><td>${linha[9]}</td></tr>`; }
        });
        document.getElementById('admin-total').innerText = count;
      }

      function mudarAba(aba) {
        document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active')); document.querySelectorAll('.tab-view').forEach(v => v.classList.remove('active'));
        if(aba === 'dashboard') { document.querySelectorAll('.admin-tab')[0].classList.add('active'); document.getElementById('tab-dashboard').classList.add('active'); } 
        else if (aba === 'config') { document.querySelectorAll('.admin-tab')[1].classList.add('active'); document.getElementById('tab-config').classList.add('active'); }
        else if (aba === 'premios') { document.querySelectorAll('.admin-tab')[2].classList.add('active'); document.getElementById('tab-premios').classList.add('active'); }
      }

      function salvarConfig() {
        document.getElementById('loading-overlay').classList.add('active'); document.querySelector('.loading-text').innerText = "Salvando...";
        
        const getPremios = (id) => {
          const lista = []; document.querySelectorAll(`#${id} .premio-row`).forEach(row => { const t = row.querySelector('.p-titulo').value; const v = row.querySelector('.p-valor').value; if(t) lista.push({titulo: t, valor: v}); }); return JSON.stringify(lista);
        };

        const novasCfgs = { 
          NOME_EVENTO: document.getElementById('cfg-nome').value, LOCAL_EVENTO: document.getElementById('cfg-local').value, URL_CAPA: document.getElementById('cfg-capa').value, URL_LOGO: document.getElementById('cfg-logo').value, FRASE_MOTIVACIONAL: document.getElementById('cfg-frase').value, SENHA_ADMIN: document.getElementById('cfg-senha').value, REGRAS_EVENTO: document.getElementById('cfg-regras').value,
          LISTA_PREMIOS: getPremios('admin-premios-list'), OBS_PREMIACAO: document.getElementById('cfg-obs-premio').value,
          LISTA_PREMIOS_CAT: getPremios('admin-premios-cat-list'), OBS_PREMIACAO_CAT: document.getElementById('cfg-obs-premio-cat').value
        };
        const dados = { action: 'salvarConfig', payload: novasCfgs };
        
        fetch(API_URL, { method: 'POST', body: JSON.stringify(dados) }).then(res => res.json()).then(res => {
             document.getElementById('loading-overlay').classList.remove('active'); 
             if(res.success) { atualizarInterface(novasCfgs); mostrarAviso("Sucesso", "Configurações salvas!", false); } else { mostrarAviso("Erro", res.message, true); } 
        }).catch(() => { document.getElementById('loading-overlay').classList.remove('active'); mostrarAviso("Erro", "Erro ao salvar.", true); });
      }
    </script>
</body>
</html>
